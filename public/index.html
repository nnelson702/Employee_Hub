<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Skye Bridge – Sales & Ops Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Supabase client CDN -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.48.0/dist/umd/supabase.js"></script>
</head>
<body>
  <!-- Top Nav -->
  <header class="top-nav">
    <div class="brand">
      <span class="brand-main">Skye Bridge</span>
      <span class="brand-sub">Sales & Operations</span>
    </div>
    <nav class="nav-links">
      <button data-route="home" class="nav-btn active">Home</button>
      <button data-route="sales" class="nav-btn">Sales</button>
      <button data-route="deptwalk" class="nav-btn">Dept Walk</button>
      <button data-route="deptwalk-results" class="nav-btn">Walk Results</button>
      <button data-route="b2b" class="nav-btn">B2B</button>
      <button data-route="eir" class="nav-btn">EIR</button>
      <button data-route="pop" class="nav-btn">POP / Library</button>
      <button data-route="admin" class="nav-btn admin-only">Admin</button>
    </nav>
    <div class="nav-auth">
      <span id="whoami" class="whoami"></span>
      <button id="btn-signin" class="pill small">Sign in</button>
      <button id="btn-signout" class="pill small hidden">Sign out</button>
    </div>
  </header>

  <!-- Global status bar -->
  <div id="status" class="status-bar"></div>

  <!-- PAGES -->
  <main>
    <!-- HOME -->
    <section id="page-home" class="page">
      <h1>Welcome</h1>
      <p>
        This internal tool supports Skye Bridge ACE Hardware stores with:
      </p>
      <ul class="bullet-list">
        <li>Sales goal setting, daily breakdowns, and performance tracking</li>
        <li>Department walk checklists and follow-up tracking</li>
        <li>B2B and EIR pipelines (coming online)</li>
        <li>POP and Library resources for in-store execution</li>
      </ul>
      <p class="muted">
        Use the navigation bar above to select a module. Sign in to unlock store data.
      </p>
    </section>

    <!-- SALES / FORECASTING -->
    <section id="page-sales" class="page hidden">
      <div class="page-header">
        <h1>Sales Goals & Daily Breakdown</h1>
        <p class="muted small">
          Set monthly goals, tune day-of-week weights, and push a finalized daily plan to the calendar.
        </p>
      </div>

      <!-- Store + Month controls -->
      <div class="toolbar">
        <div class="field">
          <label for="storeSelect">Store</label>
          <select id="storeSelect"></select>
        </div>
        <div class="field">
          <label for="monthInput">Month</label>
          <input type="month" id="monthInput" />
        </div>
        <button id="btn-load" class="pill primary">Load Month</button>
      </div>

      <!-- Summary -->
      <div id="summary" class="summary-card">
        <div class="summary-row">
          <span>Sales</span>
          <span id="summary-sales" class="summary-value">–</span>
        </div>
        <div class="summary-row">
          <span>Transactions</span>
          <span id="summary-txns" class="summary-value">–</span>
        </div>
        <div class="summary-row">
          <span>Progress vs Goal</span>
          <span id="summary-progress" class="summary-value">–</span>
        </div>
      </div>

      <!-- DOW weights -->
      <section class="card">
        <header class="card-header">
          <div>
            <h2>Day-of-Week Mix</h2>
            <p class="muted tiny">
              Use weights to shape how monthly goals are split by day. Higher = bigger share of the month.
            </p>
          </div>
          <div class="btn-row">
            <button id="btn-suggest-dow" class="pill small">Suggest from history</button>
            <button id="btn-reset-dow" class="pill small">Reset to equal & apply</button>
            <button id="btn-apply-dow" class="pill small primary">Apply to daily goals</button>
          </div>
        </header>
        <div id="dow-weights-row" class="dow-row">
          <!-- 7 cells inserted by JS -->
        </div>
        <div id="dow-status" class="microstatus"></div>
      </section>

      <!-- Calendar -->
      <section class="card">
        <header class="card-header">
          <h2>Daily Calendar</h2>
          <p class="muted tiny">
            Each cell shows either goal or actuals depending on date. Click a day for details.
          </p>
        </header>
        <div id="calendar" class="calendar-grid">
          <!-- days inserted by JS -->
        </div>
      </section>
    </section>

    <!-- DEPT WALK -->
    <section id="page-deptwalk" class="page hidden">
      <div class="page-header">
        <h1>Department Walk – Shift Readiness</h1>
        <p class="muted small">
          Quick walk to confirm in-aisle readiness, signage, and merchandising standards.
        </p>
      </div>

      <section class="card">
        <header class="card-header">
          <h2>Walk Details</h2>
        </header>
        <div class="form-grid">
          <div class="field">
            <label for="dw-store">Store</label>
            <select id="dw-store"></select>
          </div>
          <div class="field">
            <label for="dw-date">Date</label>
            <input type="date" id="dw-date" />
          </div>
          <div class="field">
            <label for="dw-area">Area / Department</label>
            <input type="text" id="dw-area" placeholder="Grills, Paint, Plumbing..." />
          </div>
          <div class="field full">
            <label for="dw-notes">Observations</label>
            <textarea id="dw-notes" rows="4" placeholder="Stock levels, facing, signage, promos, safety, etc."></textarea>
          </div>
        </div>
        <div class="btn-row right">
          <button id="btn-dw-save" class="pill primary">Save Walk (placeholder)</button>
        </div>
        <p class="muted tiny">
          Note: back-end wiring for Dept Walks can be pointed at a Supabase table matching your original
          Google Sheets / code.gs structure.
        </p>
      </section>
    </section>

    <!-- DEPT WALK RESULTS -->
    <section id="page-deptwalk-results" class="page hidden">
      <div class="page-header">
        <h1>Dept Walk Results</h1>
        <p class="muted small">
          Future home for roll-ups of dept walks, issue counts, and follow-ups by store and time period.
        </p>
      </div>
      <section class="card">
        <header class="card-header">
          <h2>Summary (Placeholder)</h2>
        </header>
        <p class="muted">
          Once wired, this view will show trends by department, recurring issues, and completion percentages.
        </p>
      </section>
    </section>

    <!-- B2B -->
    <section id="page-b2b" class="page hidden">
      <div class="page-header">
        <h1>B2B Pipeline</h1>
        <p class="muted small">
          Placeholder for tracking key business accounts, quotes, and follow-up tasks.
        </p>
      </div>
      <section class="card">
        <header class="card-header">
          <h2>Coming Soon</h2>
        </header>
        <p class="muted">
          This section will mirror your B2B champion and outside sales structure as we wire in the data model.
        </p>
      </section>
    </section>

    <!-- EIR -->
    <section id="page-eir" class="page hidden">
      <div class="page-header">
        <h1>EIR – Exception Item Review</h1>
        <p class="muted small">
          Placeholder for exception SKUs, pricing issues, and ad-hoc reports.
        </p>
      </div>
      <section class="card">
        <header class="card-header">
          <h2>Coming Soon</h2>
        </header>
        <p class="muted">
          Will eventually pull from your irregular SKU / price / promo data.
        </p>
      </section>
    </section>

    <!-- POP / Library -->
    <section id="page-pop" class="page hidden">
      <div class="page-header">
        <h1>POP / Library</h1>
        <p class="muted small">
          Placeholder for storing pdfs, images, and copy for POP, huddle boards, and visual programs.
        </p>
      </div>
      <section class="card">
        <header class="card-header">
          <h2>Coming Soon</h2>
        </header>
        <p class="muted">
          We can connect this to a Supabase storage bucket or simple content tables aligned with your campaigns.
        </p>
      </section>
    </section>

    <!-- ADMIN -->
    <section id="page-admin" class="page hidden">
      <div class="page-header">
        <h1>Admin</h1>
        <p class="muted small">
          Admin-only controls for goals, access, and settings.
        </p>
      </div>

      <!-- Monthly goals -->
      <section class="card">
        <header class="card-header">
          <div>
            <h2>Monthly Goals (Admin)</h2>
            <p class="muted tiny">
              Set store-level monthly sales and transaction goals. The Sales page will break these into daily goals.
            </p>
          </div>
        </header>
        <div class="form-grid">
          <div class="field">
            <label for="admin-store">Store</label>
            <select id="admin-store"></select>
          </div>
          <div class="field">
            <label for="admin-month">Month</label>
            <input type="month" id="admin-month" />
          </div>
          <div class="field">
            <label for="admin-sales-goal">Sales Goal</label>
            <input type="number" id="admin-sales-goal" step="0.01" />
          </div>
          <div class="field">
            <label for="admin-txn-goal">Transaction Goal</label>
            <input type="number" id="admin-txn-goal" step="1" />
          </div>
        </div>
        <div class="btn-row right">
          <button id="btn-admin-load-goals" class="pill small">Load</button>
          <button id="btn-admin-save-goals" class="pill primary small">Save Goals</button>
        </div>
        <div id="admin-goals-status" class="microstatus"></div>
      </section>

      <!-- Access management (simple stub) -->
      <section class="card">
        <header class="card-header">
          <h2>User & Tab Access (Stub)</h2>
        </header>
        <p class="muted tiny">
          We can wire this to your <code>tab_access</code> and <code>store_access</code> tables later. For now these
          are placeholders so the layout matches your intent.
        </p>
      </section>
    </section>
  </main>

  <!-- Day Details Modal -->
  <div id="dayModal" class="modal hidden">
    <div class="modal-content">
      <header class="modal-header">
        <h2 id="modalTitle">Day details</h2>
      </header>
      <div id="modal-body" class="modal-body">
        <!-- populated by JS -->
      </div>
      <footer class="modal-footer">
        <button id="btnSaveModal" class="pill primary small">Save Actuals</button>
        <button id="btn-close-modal" class="pill small">Close</button>
      </footer>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
